<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZerohedgeQuant | Professional Stock Screener & Analysis</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-card: #21262d;
            --bg-hover: #30363d;
            --bg-input: #0d1117;
            --accent-green: #3fb950;
            --accent-red: #f85149;
            --accent-blue: #58a6ff;
            --accent-yellow: #d29922;
            --accent-purple: #a371f7;
            --accent-orange: #db6d28;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --border-color: #30363d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 13px;
            line-height: 1.4;
        }

        /* Navigation - FINVIZ Style */
        .navbar {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .logo span {
            color: var(--text-muted);
            font-weight: 400;
            font-size: 0.7rem;
            display: block;
        }

        .nav-search {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-search input {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            padding: 8px 14px;
            border-radius: 4px;
            color: var(--text-primary);
            font-size: 13px;
            width: 280px;
        }

        .nav-search input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .nav-time {
            color: var(--text-secondary);
            font-size: 12px;
            font-family: 'JetBrains Mono', monospace;
        }

        .nav-links {
            display: flex;
            gap: 4px;
            padding: 8px 0;
        }

        .nav-link {
            padding: 8px 14px;
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 13px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.15s;
        }

        .nav-link:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .nav-link.active {
            background: var(--accent-blue);
            color: #fff;
        }

        /* Main Content */
        .main-content {
            padding: 16px 20px;
        }

        .page { display: none; }
        .page.active { display: block; }

        /* Announcement Bar */
        .announcement {
            background: var(--bg-secondary);
            padding: 10px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            border-bottom: 1px solid var(--border-color);
            font-size: 12px;
        }

        .announcement-new {
            background: var(--accent-yellow);
            color: #000;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: 600;
            font-size: 11px;
        }

        /* Screener Controls */
        .screener-controls {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .control-label {
            color: var(--text-secondary);
            font-size: 12px;
        }

        .control-select {
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            padding: 6px 10px;
            border-radius: 4px;
            color: var(--text-primary);
            font-size: 12px;
            cursor: pointer;
        }

        .control-select:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        /* Tab Pills */
        .tab-pills {
            display: flex;
            gap: 2px;
            background: var(--bg-secondary);
            padding: 3px;
            border-radius: 6px;
            width: fit-content;
        }

        .tab-pill {
            padding: 8px 16px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.15s;
            font-family: inherit;
        }

        .tab-pill:hover {
            color: var(--text-primary);
        }

        .tab-pill.active {
            background: var(--bg-hover);
            color: var(--text-primary);
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        /* FINVIZ-Style Filter Grid */
        .filter-panel {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-label {
            font-size: 11px;
            color: var(--text-secondary);
            min-width: 90px;
            text-align: right;
        }

        .filter-select {
            flex: 1;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            padding: 5px 8px;
            border-radius: 3px;
            color: var(--text-primary);
            font-size: 11px;
            cursor: pointer;
            min-width: 80px;
        }

        .add-filter-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            background: transparent;
            border: 1px dashed var(--border-color);
            padding: 6px 12px;
            border-radius: 4px;
            color: var(--text-secondary);
            font-size: 12px;
            cursor: pointer;
            margin-top: 12px;
        }

        .add-filter-btn:hover {
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        /* Secondary Tabs Row */
        .secondary-tabs {
            display: flex;
            gap: 2px;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
        }

        .secondary-tab {
            padding: 6px 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 11px;
            cursor: pointer;
            border-radius: 3px;
            white-space: nowrap;
            font-family: inherit;
        }

        .secondary-tab:hover, .secondary-tab.active {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        /* Table Controls */
        .table-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            font-size: 12px;
        }

        .table-info {
            color: var(--text-muted);
        }

        .table-actions {
            display: flex;
            gap: 12px;
        }

        .table-action {
            color: var(--accent-blue);
            cursor: pointer;
            text-decoration: none;
        }

        .table-action:hover {
            text-decoration: underline;
        }

        .pagination {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .page-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            padding: 4px 10px;
            border-radius: 3px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 12px;
        }

        .page-btn:hover {
            background: var(--bg-hover);
        }

        /* Data Table - FINVIZ Style */
        .data-table-container {
            overflow-x: auto;
            border: 1px solid var(--border-color);
            border-radius: 6px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            white-space: nowrap;
        }

        .data-table th {
            background: var(--bg-secondary);
            padding: 10px 12px;
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            cursor: pointer;
        }

        .data-table th:hover {
            color: var(--accent-blue);
        }

        .data-table td {
            padding: 8px 12px;
            border-bottom: 1px solid var(--border-color);
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
        }

        .data-table tbody tr {
            cursor: pointer;
            transition: background 0.1s;
        }

        .data-table tbody tr:hover {
            background: var(--bg-hover);
        }

        .data-table tbody tr:nth-child(even) {
            background: rgba(255,255,255,0.02);
        }

        .data-table tbody tr:nth-child(even):hover {
            background: var(--bg-hover);
        }

        .ticker-link {
            color: var(--accent-blue);
            font-weight: 600;
            text-decoration: none;
        }

        .ticker-link:hover {
            text-decoration: underline;
        }

        .positive { color: var(--accent-green); }
        .negative { color: var(--accent-red); }

        /* Market Overview Cards */
        .market-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .market-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
        }

        .market-card-title {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .market-card-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .market-card-change {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
        }

        /* Movers Section */
        .movers-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 24px;
        }

        .movers-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        .movers-header {
            background: var(--bg-card);
            padding: 12px 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .mover-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 16px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background 0.1s;
        }

        .mover-row:hover {
            background: var(--bg-hover);
        }

        .mover-row:last-child {
            border-bottom: none;
        }

        .mover-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .mover-ticker {
            color: var(--accent-blue);
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            font-size: 12px;
        }

        .mover-name {
            color: var(--text-secondary);
            font-size: 11px;
        }

        .mover-price {
            text-align: right;
        }

        .mover-ltp {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
        }

        .mover-change {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
        }

        /* Rating Tracker - Original Design */
        .rating-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 20px;
        }

        .rating-card {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .rating-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.3);
        }

        .rating-card-header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 1px solid var(--border-color);
        }

        .rating-agency-name {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .rating-agency-type {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .accuracy-circle {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
        }

        .accuracy-high {
            background: linear-gradient(135deg, rgba(63, 185, 80, 0.2), rgba(63, 185, 80, 0.05));
            border: 2px solid var(--accent-green);
        }

        .accuracy-medium {
            background: linear-gradient(135deg, rgba(210, 153, 34, 0.2), rgba(210, 153, 34, 0.05));
            border: 2px solid var(--accent-yellow);
        }

        .accuracy-low {
            background: linear-gradient(135deg, rgba(248, 81, 73, 0.2), rgba(248, 81, 73, 0.05));
            border: 2px solid var(--accent-red);
        }

        .accuracy-value {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .accuracy-label {
            font-size: 9px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .rating-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            padding: 16px 20px;
            gap: 12px;
            background: rgba(0,0,0,0.2);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .stat-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 4px;
        }

        .rating-picks {
            padding: 16px 20px;
        }

        .rating-picks-title {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 12px;
        }

        .pick-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .pick-row:last-child {
            border-bottom: none;
        }

        .pick-stock {
            font-family: 'JetBrains Mono', monospace;
            color: var(--accent-blue);
            font-weight: 600;
        }

        .pick-rating {
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .pick-rating.buy {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .pick-rating.sell {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        .pick-rating.hold {
            background: rgba(210, 153, 34, 0.15);
            color: var(--accent-yellow);
        }

        .pick-target {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
        }

        .pick-return {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            font-weight: 600;
        }

        /* Option Chain */
        .option-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .option-controls {
            display: flex;
            gap: 12px;
        }

        .spot-price {
            text-align: right;
        }

        .spot-label {
            font-size: 11px;
            color: var(--text-muted);
        }

        .spot-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .option-table th.call-side {
            background: rgba(63, 185, 80, 0.1);
            color: var(--accent-green);
        }

        .option-table th.put-side {
            background: rgba(248, 81, 73, 0.1);
            color: var(--accent-red);
        }

        .option-table th.strike-col {
            background: var(--accent-blue);
            color: #fff;
        }

        .option-table td.strike-col {
            background: var(--accent-blue);
            color: #fff;
            font-weight: 700;
            text-align: center;
        }

        .itm-call { background: rgba(63, 185, 80, 0.05); }
        .itm-put { background: rgba(248, 81, 73, 0.05); }
        .atm-row { background: rgba(88, 166, 255, 0.1); }

        /* Learning Hub */
        .learning-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .article-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.2s, border-color 0.2s;
        }

        .article-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent-purple);
        }

        .article-image {
            height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
        }

        .article-image.beginner { background: linear-gradient(135deg, #3fb950 0%, #238636 100%); }
        .article-image.intermediate { background: linear-gradient(135deg, #d29922 0%, #9e6a03 100%); }
        .article-image.advanced { background: linear-gradient(135deg, #a371f7 0%, #8957e5 100%); }

        .article-content {
            padding: 20px;
        }

        .article-category {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .article-category.beginner { background: rgba(63, 185, 80, 0.15); color: var(--accent-green); }
        .article-category.intermediate { background: rgba(210, 153, 34, 0.15); color: var(--accent-yellow); }
        .article-category.advanced { background: rgba(163, 113, 247, 0.15); color: var(--accent-purple); }

        .article-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .article-excerpt {
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .article-meta {
            display: flex;
            justify-content: space-between;
            color: var(--text-muted);
            font-size: 12px;
        }

        .article-link {
            color: var(--accent-blue);
            cursor: pointer;
        }

        /* Individual Stock Page */
        .stock-page-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .stock-title h1 {
            font-size: 1.75rem;
            margin-bottom: 4px;
        }

        .stock-title .ticker {
            color: var(--accent-blue);
            font-family: 'JetBrains Mono', monospace;
        }

        .stock-meta {
            color: var(--text-secondary);
            font-size: 13px;
        }

        .stock-price-display {
            text-align: right;
        }

        .stock-ltp {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
        }

        .stock-change-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            cursor: pointer;
            margin-bottom: 20px;
            font-size: 13px;
            font-family: inherit;
        }

        .back-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .indicators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .indicator-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
        }

        .indicator-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 6px;
        }

        .indicator-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .indicator-signal {
            display: inline-block;
            margin-top: 6px;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
        }

        .signal-buy { background: rgba(63, 185, 80, 0.15); color: var(--accent-green); }
        .signal-sell { background: rgba(248, 81, 73, 0.15); color: var(--accent-red); }
        .signal-neutral { background: rgba(210, 153, 34, 0.15); color: var(--accent-yellow); }

        .financial-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        .financial-table th, .financial-table td {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border-color);
            text-align: right;
        }

        .financial-table th {
            background: var(--bg-secondary);
            font-weight: 600;
            color: var(--text-secondary);
        }

        .financial-table td:first-child, .financial-table th:first-child {
            text-align: left;
        }

        .financial-table td {
            font-family: 'JetBrains Mono', monospace;
        }

        .row-label {
            font-family: 'Inter', sans-serif;
            color: var(--text-secondary);
        }

        /* Search Results Dropdown */
        .search-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 100;
            display: none;
        }

        .search-dropdown.show { display: block; }

        .search-result {
            padding: 10px 14px;
            display: flex;
            justify-content: space-between;
            cursor: pointer;
            border-bottom: 1px solid var(--border-color);
        }

        .search-result:hover { background: var(--bg-hover); }
        .search-result:last-child { border-bottom: none; }

        /* Loading indicator */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-muted);
        }

        .loading-spinner {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Status indicators */
        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            color: var(--accent-green);
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .nav-search { display: none; }
            .filter-grid { grid-template-columns: 1fr 1fr; }
            .movers-grid { grid-template-columns: 1fr; }
            .rating-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-top">
            <div class="logo">
                ZerohedgeQuant
                <span>FINANCIAL ANALYSIS</span>
            </div>
            <div class="nav-search" style="position: relative;">
                <input type="text" id="globalSearch" placeholder="Search ticker, company or profile">
                <div class="search-dropdown" id="searchDropdown"></div>
            </div>
            <div class="nav-time">
                <span id="currentTime"></span>
                <span class="live-indicator" id="liveStatus">
                    <span class="live-dot"></span>
                    LIVE
                </span>
            </div>
        </div>
        <div class="nav-links">
            <a class="nav-link active" data-page="home">Home</a>
            <a class="nav-link" data-page="screener">Screener</a>
            <a class="nav-link" data-page="optionchain">Option Chain</a>
            <a class="nav-link" data-page="ratings">Rating Tracker</a>
            <a class="nav-link" data-page="learning">Learning Hub</a>
        </div>
    </nav>

    <main class="main-content">
        <!-- HOME PAGE -->
        <div id="home" class="page active">
            <div class="market-grid" id="marketOverview">
                <div class="market-card">
                    <div class="market-card-title">NIFTY 50</div>
                    <div class="market-card-value" id="niftyPrice">--</div>
                    <div class="market-card-change" id="niftyChange">--</div>
                </div>
                <div class="market-card">
                    <div class="market-card-title">SENSEX</div>
                    <div class="market-card-value" id="sensexPrice">--</div>
                    <div class="market-card-change" id="sensexChange">--</div>
                </div>
                <div class="market-card">
                    <div class="market-card-title">BANK NIFTY</div>
                    <div class="market-card-value" id="bankniftyPrice">--</div>
                    <div class="market-card-change" id="bankniftyChange">--</div>
                </div>
                <div class="market-card">
                    <div class="market-card-title">INDIA VIX</div>
                    <div class="market-card-value" id="vixPrice">--</div>
                    <div class="market-card-change" id="vixChange">--</div>
                </div>
            </div>

            <div class="movers-grid">
                <div class="movers-card">
                    <div class="movers-header">
                        <span style="color: var(--accent-green);">▲</span> Top Gainers
                    </div>
                    <div id="topGainers">
                        <div class="loading"><div class="loading-spinner"></div></div>
                    </div>
                </div>
                <div class="movers-card">
                    <div class="movers-header">
                        <span style="color: var(--accent-red);">▼</span> Top Losers
                    </div>
                    <div id="topLosers">
                        <div class="loading"><div class="loading-spinner"></div></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SCREENER PAGE -->
        <div id="screener" class="page">
            <div class="screener-controls">
                <div class="control-group">
                    <span class="control-label">Order by</span>
                    <select class="control-select" id="orderBy">
                        <option value="ticker">Ticker</option>
                        <option value="company">Company</option>
                        <option value="marketcap">Market Cap</option>
                        <option value="price">Price</option>
                        <option value="change">Change</option>
                        <option value="volume">Volume</option>
                    </select>
                    <select class="control-select" id="orderDir">
                        <option value="asc">Asc</option>
                        <option value="desc">Desc</option>
                    </select>
                </div>
                <div class="control-group">
                    <span class="control-label">Signal</span>
                    <select class="control-select" id="signalFilter">
                        <option value="">None (all stocks)</option>
                        <option value="buy">Buy Signal</option>
                        <option value="sell">Sell Signal</option>
                    </select>
                </div>
                <div class="control-group">
                    <span class="control-label">Tickers</span>
                    <input type="text" class="control-select" style="width: 200px;" id="tickerSearch" placeholder="Search tickers...">
                </div>
                <div class="tab-pills">
                    <button class="tab-pill active" data-tab="descriptive">Descriptive</button>
                    <button class="tab-pill" data-tab="fundamental">Fundamental</button>
                    <button class="tab-pill" data-tab="technical">Technical</button>
                </div>
            </div>

            <!-- Descriptive Filters -->
            <div class="filter-panel" id="descriptiveFilters">
                <div class="filter-grid">
                    <div class="filter-item">
                        <label class="filter-label">Exchange</label>
                        <select class="filter-select" id="fExchange">
                            <option value="">Any</option>
                            <option value="NSE" selected>NSE</option>
                            <option value="BSE">BSE</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Index</label>
                        <select class="filter-select" id="fIndex">
                            <option value="">Any</option>
                            <option value="NIFTY50">Nifty 50</option>
                            <option value="NIFTY100">Nifty 100</option>
                            <option value="NIFTYNEXT50">Nifty Next 50</option>
                            <option value="NIFTY200">Nifty 200</option>
                            <option value="NIFTY500">Nifty 500</option>
                            <option value="BANKNIFTY">Bank Nifty</option>
                            <option value="NIFTYIT">Nifty IT</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Sector</label>
                        <select class="filter-select" id="fSector">
                            <option value="">Any</option>
                            <option value="IT">Information Technology</option>
                            <option value="Banking">Banking</option>
                            <option value="Financial">Financial Services</option>
                            <option value="Auto">Automobile</option>
                            <option value="Pharma">Pharmaceutical</option>
                            <option value="Energy">Energy</option>
                            <option value="FMCG">FMCG</option>
                            <option value="Metal">Metals & Mining</option>
                            <option value="Telecom">Telecom</option>
                            <option value="Realty">Realty</option>
                            <option value="Infra">Infrastructure</option>
                            <option value="Cement">Cement</option>
                            <option value="Chemical">Chemicals</option>
                            <option value="Consumer">Consumer Durables</option>
                            <option value="Media">Media</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Industry</label>
                        <select class="filter-select" id="fIndustry">
                            <option value="">Any</option>
                            <option value="Software">Software Services</option>
                            <option value="Private Bank">Private Bank</option>
                            <option value="Public Bank">Public Sector Bank</option>
                            <option value="NBFC">NBFC</option>
                            <option value="Oil & Gas">Oil & Gas</option>
                            <option value="Refinery">Refinery</option>
                            <option value="Power">Power Generation</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Country</label>
                        <select class="filter-select">
                            <option value="IN">India</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Market Cap.</label>
                        <select class="filter-select" id="fMarketCap">
                            <option value="">Any</option>
                            <option value="mega">Mega (>₹1L Cr)</option>
                            <option value="large">Large (₹20K-1L Cr)</option>
                            <option value="mid">Mid (₹5K-20K Cr)</option>
                            <option value="small">Small (₹1K-5K Cr)</option>
                            <option value="micro">Micro (<₹1K Cr)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Dividend Yield</label>
                        <select class="filter-select" id="fDividend">
                            <option value="">Any</option>
                            <option value="high">High (>3%)</option>
                            <option value="medium">Medium (1-3%)</option>
                            <option value="low">Low (0-1%)</option>
                            <option value="none">None (0%)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Avg Volume</label>
                        <select class="filter-select" id="fAvgVolume">
                            <option value="">Any</option>
                            <option value="over1m">Over 1M</option>
                            <option value="over500k">Over 500K</option>
                            <option value="over100k">Over 100K</option>
                            <option value="under100k">Under 100K</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Price $</label>
                        <select class="filter-select" id="fPrice">
                            <option value="">Any</option>
                            <option value="over1000">Over ₹1000</option>
                            <option value="500to1000">₹500-1000</option>
                            <option value="100to500">₹100-500</option>
                            <option value="under100">Under ₹100</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Target Price</label>
                        <select class="filter-select" id="fTarget">
                            <option value="">Any</option>
                            <option value="above">Above Current</option>
                            <option value="below">Below Current</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Fundamental Filters -->
            <div class="filter-panel" id="fundamentalFilters" style="display: none;">
                <div class="filter-grid">
                    <div class="filter-item">
                        <label class="filter-label">P/E</label>
                        <select class="filter-select" id="fPE">
                            <option value="">Any</option>
                            <option value="low">Low (<15)</option>
                            <option value="medium">Medium (15-25)</option>
                            <option value="high">High (25-50)</option>
                            <option value="veryhigh">Very High (>50)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Forward P/E</label>
                        <select class="filter-select" id="fForwardPE">
                            <option value="">Any</option>
                            <option value="low">Low (<15)</option>
                            <option value="medium">Medium (15-25)</option>
                            <option value="high">High (>25)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">PEG</label>
                        <select class="filter-select" id="fPEG">
                            <option value="">Any</option>
                            <option value="low">Low (<1)</option>
                            <option value="medium">Medium (1-2)</option>
                            <option value="high">High (>2)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">P/S</label>
                        <select class="filter-select" id="fPS">
                            <option value="">Any</option>
                            <option value="low">Low (<1)</option>
                            <option value="medium">Medium (1-5)</option>
                            <option value="high">High (>5)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">P/B</label>
                        <select class="filter-select" id="fPB">
                            <option value="">Any</option>
                            <option value="low">Low (<1)</option>
                            <option value="medium">Medium (1-3)</option>
                            <option value="high">High (>3)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Price/Cash</label>
                        <select class="filter-select" id="fPriceCash">
                            <option value="">Any</option>
                            <option value="low">Low (<3)</option>
                            <option value="medium">Medium (3-10)</option>
                            <option value="high">High (>10)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">EV/EBITDA</label>
                        <select class="filter-select" id="fEVEBITDA">
                            <option value="">Any</option>
                            <option value="low">Low (<10)</option>
                            <option value="medium">Medium (10-20)</option>
                            <option value="high">High (>20)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">EV/Sales</label>
                        <select class="filter-select" id="fEVSales">
                            <option value="">Any</option>
                            <option value="low">Low (<1)</option>
                            <option value="medium">Medium (1-3)</option>
                            <option value="high">High (>3)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">EPS Growth This Yr</label>
                        <select class="filter-select" id="fEPSGrowth">
                            <option value="">Any</option>
                            <option value="positive">Positive (>0%)</option>
                            <option value="high">High (>25%)</option>
                            <option value="negative">Negative</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">EPS Growth Next Yr</label>
                        <select class="filter-select" id="fEPSGrowthNext">
                            <option value="">Any</option>
                            <option value="positive">Positive (>0%)</option>
                            <option value="high">High (>25%)</option>
                            <option value="negative">Negative</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Sales Growth 5Y</label>
                        <select class="filter-select" id="fSalesGrowth5Y">
                            <option value="">Any</option>
                            <option value="positive">Positive</option>
                            <option value="high">High (>15%)</option>
                            <option value="negative">Negative</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Return on Assets</label>
                        <select class="filter-select" id="fROA">
                            <option value="">Any</option>
                            <option value="positive">Positive (>0%)</option>
                            <option value="high">High (>10%)</option>
                            <option value="veryhigh">Very High (>20%)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Return on Equity</label>
                        <select class="filter-select" id="fROE">
                            <option value="">Any</option>
                            <option value="positive">Positive (>0%)</option>
                            <option value="high">High (>15%)</option>
                            <option value="veryhigh">Very High (>30%)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Current Ratio</label>
                        <select class="filter-select" id="fCurrentRatio">
                            <option value="">Any</option>
                            <option value="high">High (>2)</option>
                            <option value="medium">Medium (1-2)</option>
                            <option value="low">Low (<1)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Quick Ratio</label>
                        <select class="filter-select" id="fQuickRatio">
                            <option value="">Any</option>
                            <option value="high">High (>1)</option>
                            <option value="low">Low (<1)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">LT Debt/Equity</label>
                        <select class="filter-select" id="fLTDebtEquity">
                            <option value="">Any</option>
                            <option value="low">Low (<0.3)</option>
                            <option value="medium">Medium (0.3-0.7)</option>
                            <option value="high">High (>0.7)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Debt/Equity</label>
                        <select class="filter-select" id="fDebtEquity">
                            <option value="">Any</option>
                            <option value="low">Low (<0.5)</option>
                            <option value="medium">Medium (0.5-1)</option>
                            <option value="high">High (>1)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Gross Margin</label>
                        <select class="filter-select" id="fGrossMargin">
                            <option value="">Any</option>
                            <option value="positive">Positive (>0%)</option>
                            <option value="high">High (>50%)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Operating Margin</label>
                        <select class="filter-select" id="fOperatingMargin">
                            <option value="">Any</option>
                            <option value="positive">Positive (>0%)</option>
                            <option value="high">High (>20%)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Net Profit Margin</label>
                        <select class="filter-select" id="fNetProfitMargin">
                            <option value="">Any</option>
                            <option value="positive">Positive (>0%)</option>
                            <option value="high">High (>15%)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Technical Filters -->
            <div class="filter-panel" id="technicalFilters" style="display: none;">
                <div class="filter-grid">
                    <div class="filter-item">
                        <label class="filter-label">Performance</label>
                        <select class="filter-select" id="fPerformance">
                            <option value="">Any</option>
                            <option value="today_up">Today Up</option>
                            <option value="today_down">Today Down</option>
                            <option value="week_up">Week Up</option>
                            <option value="week_down">Week Down</option>
                            <option value="month_up">Month Up</option>
                            <option value="month_down">Month Down</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Performance 2</label>
                        <select class="filter-select" id="fPerformance2">
                            <option value="">Any</option>
                            <option value="ytd_up">YTD Up</option>
                            <option value="ytd_down">YTD Down</option>
                            <option value="year_up">Year Up</option>
                            <option value="year_down">Year Down</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Volatility</label>
                        <select class="filter-select" id="fVolatility">
                            <option value="">Any</option>
                            <option value="week_over3">Week >3%</option>
                            <option value="week_over5">Week >5%</option>
                            <option value="month_over5">Month >5%</option>
                            <option value="month_over10">Month >10%</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">RSI (14)</label>
                        <select class="filter-select" id="fRSI">
                            <option value="">Any</option>
                            <option value="overbought">Overbought (>70)</option>
                            <option value="high">High (60-70)</option>
                            <option value="neutral">Neutral (40-60)</option>
                            <option value="low">Low (30-40)</option>
                            <option value="oversold">Oversold (<30)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Gap</label>
                        <select class="filter-select" id="fGap">
                            <option value="">Any</option>
                            <option value="up">Gap Up</option>
                            <option value="up_2">Gap Up >2%</option>
                            <option value="down">Gap Down</option>
                            <option value="down_2">Gap Down >2%</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">20-Day SMA</label>
                        <select class="filter-select" id="f20SMA">
                            <option value="">Any</option>
                            <option value="above">Price Above SMA20</option>
                            <option value="below">Price Below SMA20</option>
                            <option value="cross_above">SMA20 Cross Above</option>
                            <option value="cross_below">SMA20 Cross Below</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">50-Day SMA</label>
                        <select class="filter-select" id="f50SMA">
                            <option value="">Any</option>
                            <option value="above">Price Above SMA50</option>
                            <option value="below">Price Below SMA50</option>
                            <option value="cross_above">SMA50 Cross Above</option>
                            <option value="cross_below">SMA50 Cross Below</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">200-Day SMA</label>
                        <select class="filter-select" id="f200SMA">
                            <option value="">Any</option>
                            <option value="above">Price Above SMA200</option>
                            <option value="below">Price Below SMA200</option>
                            <option value="cross_above">SMA200 Cross Above</option>
                            <option value="cross_below">SMA200 Cross Below</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Change</label>
                        <select class="filter-select" id="fChange">
                            <option value="">Any</option>
                            <option value="up">Up</option>
                            <option value="up_1">Up >1%</option>
                            <option value="up_3">Up >3%</option>
                            <option value="up_5">Up >5%</option>
                            <option value="down">Down</option>
                            <option value="down_1">Down >1%</option>
                            <option value="down_3">Down >3%</option>
                            <option value="down_5">Down >5%</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Change from Open</label>
                        <select class="filter-select" id="fChangeOpen">
                            <option value="">Any</option>
                            <option value="up">Up</option>
                            <option value="down">Down</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">20-Day High/Low</label>
                        <select class="filter-select" id="f20HighLow">
                            <option value="">Any</option>
                            <option value="new_high">New High</option>
                            <option value="new_low">New Low</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">50-Day High/Low</label>
                        <select class="filter-select" id="f50HighLow">
                            <option value="">Any</option>
                            <option value="new_high">New High</option>
                            <option value="new_low">New Low</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">52-Week High/Low</label>
                        <select class="filter-select" id="f52WeekHL">
                            <option value="">Any</option>
                            <option value="new_high">New High</option>
                            <option value="near_high">Within 5% of High</option>
                            <option value="near_low">Within 5% of Low</option>
                            <option value="new_low">New Low</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">All-Time High/Low</label>
                        <select class="filter-select" id="fATHL">
                            <option value="">Any</option>
                            <option value="new_high">New High</option>
                            <option value="new_low">New Low</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Beta</label>
                        <select class="filter-select" id="fBeta">
                            <option value="">Any</option>
                            <option value="low">Low (<0.5)</option>
                            <option value="medium_low">0.5-1.0</option>
                            <option value="medium_high">1.0-1.5</option>
                            <option value="high">High (>1.5)</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Average True Range</label>
                        <select class="filter-select" id="fATR">
                            <option value="">Any</option>
                            <option value="high">High</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Candlestick</label>
                        <select class="filter-select" id="fCandlestick">
                            <option value="">Any</option>
                            <option value="doji">Doji</option>
                            <option value="hammer">Hammer</option>
                            <option value="engulfing_bull">Bullish Engulfing</option>
                            <option value="engulfing_bear">Bearish Engulfing</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label class="filter-label">Pattern</label>
                        <select class="filter-select" id="fPattern">
                            <option value="">Any</option>
                            <option value="double_top">Double Top</option>
                            <option value="double_bottom">Double Bottom</option>
                            <option value="head_shoulders">Head & Shoulders</option>
                            <option value="triangle">Triangle</option>
                            <option value="wedge">Wedge</option>
                            <option value="channel">Channel</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Secondary Tabs -->
            <div class="secondary-tabs">
                <button class="secondary-tab active">Overview</button>
                <button class="secondary-tab">Valuation</button>
                <button class="secondary-tab">Financial</button>
                <button class="secondary-tab">Ownership</button>
                <button class="secondary-tab">Performance</button>
                <button class="secondary-tab">Technical</button>
                <button class="secondary-tab">Charts</button>
                <button class="secondary-tab">Tickers</button>
                <button class="secondary-tab">TA</button>
                <button class="secondary-tab">News</button>
                <button class="secondary-tab">Snapshot</button>
            </div>

            <!-- Table Controls -->
            <div class="table-controls">
                <div class="table-info">
                    <span id="stockCount">#1 / -- Total</span>
                </div>
                <div class="table-actions">
                    <a class="table-action">save as portfolio</a>
                    <a class="table-action">create alert</a>
                    <span>Refresh: <a class="table-action">3min</a> | <a class="table-action">off</a></span>
                </div>
                <div class="pagination">
                    <button class="page-btn">←</button>
                    <span id="pageInfo">Page 1 / 1</span>
                    <button class="page-btn">→</button>
                </div>
            </div>

            <!-- Data Table -->
            <div class="data-table-container">
                <table class="data-table" id="stockTable">
                    <thead id="tableHead">
                        <!-- Dynamic headers -->
                    </thead>
                    <tbody id="tableBody">
                        <tr><td colspan="10" class="loading"><div class="loading-spinner"></div></td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- OPTION CHAIN PAGE -->
        <div id="optionchain" class="page">
            <h2 style="margin-bottom: 20px;">Option Chain</h2>
            
            <div class="option-header">
                <div class="option-controls">
                    <select class="control-select" id="optionUnderlying" style="min-width: 180px;">
                        <option value="NIFTY">NIFTY 50</option>
                        <option value="BANKNIFTY">BANK NIFTY</option>
                        <option value="FINNIFTY">FIN NIFTY</option>
                        <option value="RELIANCE">RELIANCE</option>
                        <option value="TCS">TCS</option>
                        <option value="HDFCBANK">HDFC BANK</option>
                        <option value="INFY">INFOSYS</option>
                        <option value="ICICIBANK">ICICI BANK</option>
                        <option value="SBIN">SBI</option>
                        <option value="BHARTIARTL">BHARTI AIRTEL</option>
                        <option value="ITC">ITC</option>
                        <option value="KOTAKBANK">KOTAK BANK</option>
                        <option value="LT">L&T</option>
                        <option value="AXISBANK">AXIS BANK</option>
                        <option value="TATAMOTORS">TATA MOTORS</option>
                    </select>
                    <select class="control-select" id="optionExpiry">
                        <option value="2026-02-13">13 Feb 2026</option>
                        <option value="2026-02-20">20 Feb 2026</option>
                        <option value="2026-02-27">27 Feb 2026</option>
                        <option value="2026-03-27">27 Mar 2026</option>
                    </select>
                </div>
                <div class="spot-price">
                    <div class="spot-label">Spot Price</div>
                    <div class="spot-value" id="spotPrice">--</div>
                </div>
            </div>

            <div class="data-table-container">
                <table class="data-table option-table">
                    <thead>
                        <tr>
                            <th class="call-side">OI</th>
                            <th class="call-side">Chng in OI</th>
                            <th class="call-side">Volume</th>
                            <th class="call-side">IV</th>
                            <th class="call-side">LTP</th>
                            <th class="call-side">Chng</th>
                            <th class="strike-col">STRIKE</th>
                            <th class="put-side">Chng</th>
                            <th class="put-side">LTP</th>
                            <th class="put-side">IV</th>
                            <th class="put-side">Volume</th>
                            <th class="put-side">Chng in OI</th>
                            <th class="put-side">OI</th>
                        </tr>
                    </thead>
                    <tbody id="optionChainBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- RATING TRACKER PAGE -->
        <div id="ratings" class="page">
            <h2 style="margin-bottom: 8px;">Rating Tracker</h2>
            <p style="color: var(--text-secondary); margin-bottom: 24px;">Track analyst recommendations and their historical accuracy</p>
            
            <div class="rating-grid" id="ratingGrid">
                <!-- Filled by JS -->
            </div>
        </div>

        <!-- LEARNING HUB PAGE -->
        <div id="learning" class="page">
            <h2 style="margin-bottom: 8px;">Learning Hub</h2>
            <p style="color: var(--text-secondary); margin-bottom: 24px;">Master quantitative finance from basics to advanced strategies</p>
            
            <div class="learning-grid" id="learningGrid">
                <!-- Filled by JS -->
            </div>
        </div>

        <!-- STOCK DETAIL PAGE -->
        <div id="stockDetail" class="page">
            <button class="back-btn" onclick="showPage('screener')">← Back to Screener</button>
            
            <div class="stock-page-header">
                <div class="stock-title">
                    <h1><span id="detailName">--</span> <span class="ticker" id="detailTicker">--</span></h1>
                    <div class="stock-meta" id="detailMeta">--</div>
                </div>
                <div class="stock-price-display">
                    <div class="stock-ltp" id="detailPrice">--</div>
                    <div class="stock-change-display" id="detailChange">--</div>
                </div>
            </div>

            <div class="tab-pills" style="margin-bottom: 20px;">
                <button class="tab-pill active" data-stocktab="technical">Technical</button>
                <button class="tab-pill" data-stocktab="fundamental">Fundamental</button>
            </div>

            <div id="stockTechnicalTab">
                <div class="indicators-grid" id="indicatorsGrid"></div>
            </div>

            <div id="stockFundamentalTab" style="display: none;">
                <div class="indicators-grid" id="ratiosGrid"></div>
                <div style="margin-top: 24px;">
                    <h3 style="margin-bottom: 16px;">Profit & Loss (₹ Cr)</h3>
                    <div class="data-table-container">
                        <table class="financial-table" id="plTable"></table>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // ==================== CONFIGURATION ====================
        // Replace with your actual backend URL from Render
        const API_URL = 'https://zerohedgequant-api.onrender.com';
        
        // ==================== NSE STOCK DATA ====================
        // Comprehensive list of NSE stocks with realistic data
        const nseStocks = [
            { ticker: 'RELIANCE', name: 'Reliance Industries Ltd', sector: 'Energy', industry: 'Oil & Gas', index: 'NIFTY50', marketCap: 1932000, pe: 28.45, pb: 2.34, roe: 15.8, roa: 7.2, debtEquity: 0.45, dividend: 0.35, rsi: 58.45, beta: 1.15, eps: 100.34 },
            { ticker: 'TCS', name: 'Tata Consultancy Services Ltd', sector: 'IT', industry: 'Software', index: 'NIFTY50', marketCap: 1510000, pe: 32.15, pb: 14.56, roe: 48.5, roa: 24.2, debtEquity: 0.05, dividend: 1.25, rsi: 42.30, beta: 0.75, eps: 128.34 },
            { ticker: 'HDFCBANK', name: 'HDFC Bank Ltd', sector: 'Banking', industry: 'Private Bank', index: 'NIFTY50', marketCap: 1280000, pe: 19.80, pb: 2.85, roe: 16.5, roa: 1.95, debtEquity: 0.00, dividend: 1.10, rsi: 65.80, beta: 0.95, eps: 85.12 },
            { ticker: 'INFY', name: 'Infosys Ltd', sector: 'IT', industry: 'Software', index: 'NIFTY50', marketCap: 756000, pe: 28.90, pb: 8.45, roe: 32.4, roa: 18.6, debtEquity: 0.08, dividend: 2.35, rsi: 38.50, beta: 0.82, eps: 63.15 },
            { ticker: 'ICICIBANK', name: 'ICICI Bank Ltd', sector: 'Banking', industry: 'Private Bank', index: 'NIFTY50', marketCap: 875000, pe: 18.45, pb: 3.12, roe: 18.2, roa: 2.15, debtEquity: 0.00, dividend: 0.85, rsi: 62.40, beta: 1.08, eps: 67.52 },
            { ticker: 'BHARTIARTL', name: 'Bharti Airtel Ltd', sector: 'Telecom', industry: 'Telecom', index: 'NIFTY50', marketCap: 945000, pe: 85.60, pb: 7.25, roe: 8.5, roa: 3.2, debtEquity: 1.45, dividend: 0.45, rsi: 72.30, beta: 0.88, eps: 18.46 },
            { ticker: 'SBIN', name: 'State Bank of India', sector: 'Banking', industry: 'Public Bank', index: 'NIFTY50', marketCap: 736000, pe: 11.20, pb: 1.85, roe: 18.5, roa: 1.05, debtEquity: 0.00, dividend: 1.85, rsi: 44.20, beta: 1.25, eps: 73.68 },
            { ticker: 'ITC', name: 'ITC Ltd', sector: 'FMCG', industry: 'FMCG', index: 'NIFTY50', marketCap: 582000, pe: 28.50, pb: 7.80, roe: 28.5, roa: 18.2, debtEquity: 0.00, dividend: 3.45, rsi: 55.60, beta: 0.65, eps: 16.34 },
            { ticker: 'HINDUNILVR', name: 'Hindustan Unilever Ltd', sector: 'FMCG', industry: 'FMCG', index: 'NIFTY50', marketCap: 584000, pe: 58.90, pb: 12.45, roe: 21.5, roa: 16.8, debtEquity: 0.00, dividend: 1.65, rsi: 35.80, beta: 0.45, eps: 42.18 },
            { ticker: 'KOTAKBANK', name: 'Kotak Mahindra Bank Ltd', sector: 'Banking', industry: 'Private Bank', index: 'NIFTY50', marketCap: 354000, pe: 21.30, pb: 3.25, roe: 14.8, roa: 2.35, debtEquity: 0.00, dividend: 0.12, rsi: 68.40, beta: 1.02, eps: 83.82 },
            { ticker: 'LT', name: 'Larsen & Toubro Ltd', sector: 'Infra', industry: 'Infrastructure', index: 'NIFTY50', marketCap: 485000, pe: 34.50, pb: 5.12, roe: 15.2, roa: 4.8, debtEquity: 0.85, dividend: 0.72, rsi: 52.30, beta: 1.18, eps: 102.45 },
            { ticker: 'AXISBANK', name: 'Axis Bank Ltd', sector: 'Banking', industry: 'Private Bank', index: 'NIFTY50', marketCap: 356000, pe: 14.80, pb: 2.15, roe: 16.8, roa: 1.85, debtEquity: 0.00, dividend: 0.25, rsi: 58.90, beta: 1.22, eps: 78.45 },
            { ticker: 'WIPRO', name: 'Wipro Ltd', sector: 'IT', industry: 'Software', index: 'NIFTY50', marketCap: 253000, pe: 22.40, pb: 3.85, roe: 17.2, roa: 9.8, debtEquity: 0.25, dividend: 0.42, rsi: 32.50, beta: 0.78, eps: 21.66 },
            { ticker: 'TATAMOTORS', name: 'Tata Motors Ltd', sector: 'Auto', industry: 'Automobile', index: 'NIFTY50', marketCap: 292000, pe: 8.50, pb: 2.15, roe: 28.5, roa: 5.8, debtEquity: 0.85, dividend: 0.00, rsi: 78.60, beta: 1.65, eps: 92.42 },
            { ticker: 'SUNPHARMA', name: 'Sun Pharmaceutical Industries Ltd', sector: 'Pharma', industry: 'Pharmaceutical', index: 'NIFTY50', marketCap: 425000, pe: 38.20, pb: 4.85, roe: 12.8, roa: 8.5, debtEquity: 0.15, dividend: 0.45, rsi: 61.20, beta: 0.58, eps: 46.78 },
            { ticker: 'MARUTI', name: 'Maruti Suzuki India Ltd', sector: 'Auto', industry: 'Automobile', index: 'NIFTY50', marketCap: 385000, pe: 28.90, pb: 4.25, roe: 15.2, roa: 9.8, debtEquity: 0.00, dividend: 0.85, rsi: 54.80, beta: 0.92, eps: 425.60 },
            { ticker: 'TITAN', name: 'Titan Company Ltd', sector: 'Consumer', industry: 'Consumer Durables', index: 'NIFTY50', marketCap: 298000, pe: 85.40, pb: 22.50, roe: 28.5, roa: 12.5, debtEquity: 0.35, dividend: 0.32, rsi: 48.20, beta: 1.05, eps: 38.45 },
            { ticker: 'ASIANPAINT', name: 'Asian Paints Ltd', sector: 'Chemical', industry: 'Chemicals', index: 'NIFTY50', marketCap: 268000, pe: 62.30, pb: 18.90, roe: 32.5, roa: 18.2, debtEquity: 0.12, dividend: 0.65, rsi: 38.90, beta: 0.72, eps: 45.20 },
            { ticker: 'BAJFINANCE', name: 'Bajaj Finance Ltd', sector: 'Financial', industry: 'NBFC', index: 'NIFTY50', marketCap: 428000, pe: 32.80, pb: 6.85, roe: 22.5, roa: 4.2, debtEquity: 3.25, dividend: 0.18, rsi: 56.40, beta: 1.35, eps: 215.80 },
            { ticker: 'HCLTECH', name: 'HCL Technologies Ltd', sector: 'IT', industry: 'Software', index: 'NIFTY50', marketCap: 445000, pe: 25.60, pb: 6.25, roe: 24.8, roa: 14.5, debtEquity: 0.08, dividend: 2.85, rsi: 45.60, beta: 0.85, eps: 65.40 },
            { ticker: 'NTPC', name: 'NTPC Ltd', sector: 'Energy', industry: 'Power', index: 'NIFTY50', marketCap: 385000, pe: 18.20, pb: 2.15, roe: 12.5, roa: 4.8, debtEquity: 1.25, dividend: 2.45, rsi: 62.80, beta: 0.78, eps: 22.45 },
            { ticker: 'POWERGRID', name: 'Power Grid Corporation of India Ltd', sector: 'Energy', industry: 'Power', index: 'NIFTY50', marketCap: 285000, pe: 16.80, pb: 2.85, roe: 18.2, roa: 5.2, debtEquity: 1.85, dividend: 4.25, rsi: 58.40, beta: 0.65, eps: 18.90 },
            { ticker: 'ONGC', name: 'Oil and Natural Gas Corporation Ltd', sector: 'Energy', industry: 'Oil & Gas', index: 'NIFTY50', marketCap: 325000, pe: 8.50, pb: 0.95, roe: 12.5, roa: 6.8, debtEquity: 0.45, dividend: 5.85, rsi: 48.20, beta: 1.12, eps: 32.45 },
            { ticker: 'COALINDIA', name: 'Coal India Ltd', sector: 'Energy', industry: 'Mining', index: 'NIFTY50', marketCap: 285000, pe: 7.80, pb: 2.45, roe: 35.2, roa: 18.5, debtEquity: 0.08, dividend: 6.25, rsi: 42.60, beta: 0.85, eps: 58.90 },
            { ticker: 'JSWSTEEL', name: 'JSW Steel Ltd', sector: 'Metal', industry: 'Steel', index: 'NIFTY50', marketCap: 228000, pe: 42.50, pb: 3.25, roe: 8.5, roa: 3.2, debtEquity: 1.15, dividend: 0.45, rsi: 52.80, beta: 1.45, eps: 22.15 },
            { ticker: 'TATASTEEL', name: 'Tata Steel Ltd', sector: 'Metal', industry: 'Steel', index: 'NIFTY50', marketCap: 185000, pe: 58.20, pb: 1.85, roe: 3.5, roa: 1.2, debtEquity: 0.95, dividend: 1.25, rsi: 38.40, beta: 1.52, eps: 2.65 },
            { ticker: 'HINDALCO', name: 'Hindalco Industries Ltd', sector: 'Metal', industry: 'Aluminum', index: 'NIFTY50', marketCap: 145000, pe: 12.80, pb: 1.45, roe: 12.5, roa: 4.8, debtEquity: 0.65, dividend: 0.52, rsi: 55.20, beta: 1.38, eps: 52.80 },
            { ticker: 'ADANIENT', name: 'Adani Enterprises Ltd', sector: 'Infra', industry: 'Infrastructure', index: 'NIFTY50', marketCap: 385000, pe: 85.60, pb: 12.45, roe: 15.2, roa: 2.8, debtEquity: 1.85, dividend: 0.05, rsi: 62.40, beta: 1.85, eps: 35.80 },
            { ticker: 'ADANIPORTS', name: 'Adani Ports and SEZ Ltd', sector: 'Infra', industry: 'Infrastructure', index: 'NIFTY50', marketCap: 285000, pe: 32.50, pb: 5.85, roe: 18.5, roa: 6.2, debtEquity: 0.95, dividend: 0.35, rsi: 58.80, beta: 1.42, eps: 42.60 },
            { ticker: 'ULTRACEMCO', name: 'UltraTech Cement Ltd', sector: 'Cement', industry: 'Cement', index: 'NIFTY50', marketCap: 325000, pe: 42.80, pb: 5.25, roe: 12.8, roa: 6.5, debtEquity: 0.35, dividend: 0.35, rsi: 48.60, beta: 1.05, eps: 265.40 },
            { ticker: 'GRASIM', name: 'Grasim Industries Ltd', sector: 'Cement', industry: 'Cement', index: 'NIFTY50', marketCap: 165000, pe: 18.50, pb: 1.85, roe: 10.5, roa: 4.2, debtEquity: 0.45, dividend: 0.85, rsi: 52.40, beta: 1.12, eps: 135.80 },
            { ticker: 'TECHM', name: 'Tech Mahindra Ltd', sector: 'IT', industry: 'Software', index: 'NIFTY50', marketCap: 142000, pe: 38.50, pb: 4.25, roe: 11.5, roa: 6.8, debtEquity: 0.15, dividend: 1.85, rsi: 35.80, beta: 0.92, eps: 42.60 },
            { ticker: 'DRREDDY', name: 'Dr. Reddys Laboratories Ltd', sector: 'Pharma', industry: 'Pharmaceutical', index: 'NIFTY50', marketCap: 108000, pe: 22.40, pb: 3.85, roe: 18.2, roa: 10.5, debtEquity: 0.12, dividend: 0.65, rsi: 58.40, beta: 0.48, eps: 285.60 },
            { ticker: 'CIPLA', name: 'Cipla Ltd', sector: 'Pharma', industry: 'Pharmaceutical', index: 'NIFTY50', marketCap: 125000, pe: 28.90, pb: 4.85, roe: 17.5, roa: 11.2, debtEquity: 0.08, dividend: 0.52, rsi: 62.80, beta: 0.55, eps: 55.40 },
            { ticker: 'APOLLOHOSP', name: 'Apollo Hospitals Enterprise Ltd', sector: 'Pharma', industry: 'Healthcare', index: 'NIFTY50', marketCap: 95000, pe: 82.50, pb: 12.85, roe: 16.5, roa: 5.8, debtEquity: 0.45, dividend: 0.18, rsi: 48.20, beta: 0.72, eps: 78.90 },
            { ticker: 'EICHERMOT', name: 'Eicher Motors Ltd', sector: 'Auto', industry: 'Automobile', index: 'NIFTY50', marketCap: 128000, pe: 35.80, pb: 8.45, roe: 25.2, roa: 15.8, debtEquity: 0.02, dividend: 0.45, rsi: 55.60, beta: 0.95, eps: 135.20 },
            { ticker: 'BAJAJ-AUTO', name: 'Bajaj Auto Ltd', sector: 'Auto', industry: 'Automobile', index: 'NIFTY50', marketCap: 245000, pe: 32.50, pb: 8.25, roe: 26.5, roa: 18.2, debtEquity: 0.00, dividend: 1.85, rsi: 62.40, beta: 0.88, eps: 285.40 },
            { ticker: 'HEROMOTOCO', name: 'Hero MotoCorp Ltd', sector: 'Auto', industry: 'Automobile', index: 'NIFTY50', marketCap: 98000, pe: 24.80, pb: 4.85, roe: 20.5, roa: 12.8, debtEquity: 0.00, dividend: 2.45, rsi: 48.80, beta: 0.82, eps: 198.60 },
            { ticker: 'M&M', name: 'Mahindra & Mahindra Ltd', sector: 'Auto', industry: 'Automobile', index: 'NIFTY50', marketCap: 385000, pe: 28.90, pb: 4.25, roe: 15.8, roa: 6.5, debtEquity: 0.35, dividend: 0.65, rsi: 68.40, beta: 1.15, eps: 108.90 },
            { ticker: 'NESTLEIND', name: 'Nestle India Ltd', sector: 'FMCG', industry: 'FMCG', index: 'NIFTY50', marketCap: 225000, pe: 78.50, pb: 85.20, roe: 125.5, roa: 22.5, debtEquity: 0.00, dividend: 1.25, rsi: 42.60, beta: 0.45, eps: 298.40 },
            { ticker: 'BRITANNIA', name: 'Britannia Industries Ltd', sector: 'FMCG', industry: 'FMCG', index: 'NIFTY50', marketCap: 128000, pe: 58.90, pb: 35.80, roe: 65.2, roa: 15.8, debtEquity: 0.45, dividend: 1.85, rsi: 38.40, beta: 0.52, eps: 92.60 },
            { ticker: 'DIVISLAB', name: 'Divis Laboratories Ltd', sector: 'Pharma', industry: 'Pharmaceutical', index: 'NIFTY50', marketCap: 125000, pe: 62.80, pb: 9.85, roe: 16.2, roa: 12.5, debtEquity: 0.00, dividend: 0.45, rsi: 45.20, beta: 0.62, eps: 78.40 },
            { ticker: 'BPCL', name: 'Bharat Petroleum Corporation Ltd', sector: 'Energy', industry: 'Oil & Gas', index: 'NIFTY50', marketCap: 145000, pe: 6.80, pb: 1.85, roe: 28.5, roa: 8.2, debtEquity: 0.65, dividend: 4.85, rsi: 58.20, beta: 1.08, eps: 98.60 },
            { ticker: 'IOC', name: 'Indian Oil Corporation Ltd', sector: 'Energy', industry: 'Oil & Gas', index: 'NIFTY50', marketCap: 195000, pe: 8.50, pb: 1.25, roe: 15.8, roa: 4.5, debtEquity: 0.85, dividend: 5.25, rsi: 52.40, beta: 0.95, eps: 16.80 },
            { ticker: 'INDUSINDBK', name: 'IndusInd Bank Ltd', sector: 'Banking', industry: 'Private Bank', index: 'NIFTY50', marketCap: 85000, pe: 12.50, pb: 1.45, roe: 12.5, roa: 1.25, debtEquity: 0.00, dividend: 0.85, rsi: 32.80, beta: 1.45, eps: 85.20 },
            { ticker: 'TATACONSUM', name: 'Tata Consumer Products Ltd', sector: 'FMCG', industry: 'FMCG', index: 'NIFTY50', marketCap: 108000, pe: 72.50, pb: 8.45, roe: 12.5, roa: 6.2, debtEquity: 0.25, dividend: 0.45, rsi: 48.60, beta: 0.68, eps: 15.80 },
            { ticker: 'SBILIFE', name: 'SBI Life Insurance Company Ltd', sector: 'Financial', industry: 'Insurance', index: 'NIFTY50', marketCap: 165000, pe: 78.50, pb: 12.85, roe: 16.8, roa: 1.85, debtEquity: 0.00, dividend: 0.25, rsi: 55.40, beta: 0.85, eps: 18.60 },
            { ticker: 'HDFCLIFE', name: 'HDFC Life Insurance Company Ltd', sector: 'Financial', industry: 'Insurance', index: 'NIFTY50', marketCap: 145000, pe: 92.50, pb: 15.85, roe: 17.5, roa: 1.65, debtEquity: 0.00, dividend: 0.32, rsi: 42.80, beta: 0.78, eps: 7.25 },
            { ticker: 'SHRIRAMFIN', name: 'Shriram Finance Ltd', sector: 'Financial', industry: 'NBFC', index: 'NIFTY50', marketCap: 108000, pe: 14.80, pb: 2.25, roe: 16.2, roa: 2.85, debtEquity: 4.25, dividend: 1.25, rsi: 62.40, beta: 1.18, eps: 185.60 },
        ];

        // Add simulated prices
        nseStocks.forEach(stock => {
            const basePrice = Math.random() * 4000 + 100;
            stock.price = parseFloat(basePrice.toFixed(2));
            stock.change = parseFloat((Math.random() * 10 - 5).toFixed(2));
            stock.changePct = parseFloat(((stock.change / stock.price) * 100).toFixed(2));
            stock.volume = Math.floor(Math.random() * 20000000) + 100000;
            stock.open = parseFloat((stock.price - stock.change).toFixed(2));
            stock.high = parseFloat((stock.price * (1 + Math.random() * 0.03)).toFixed(2));
            stock.low = parseFloat((stock.price * (1 - Math.random() * 0.03)).toFixed(2));
            stock.sma50 = stock.change > 0 ? 'Above' : 'Below';
            stock.sma200 = Math.random() > 0.4 ? 'Above' : 'Below';
        });

        let stockData = [...nseStocks];
        let currentPage = 1;
        const pageSize = 20;

        // ==================== NAVIGATION ====================
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            document.querySelector(`[data-page="${pageId}"]`)?.classList.add('active');
        }

        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => showPage(link.dataset.page));
        });

        // ==================== TIME UPDATE ====================
        function updateTime() {
            const now = new Date();
            const options = { weekday: 'short', month: 'short', day: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            document.getElementById('currentTime').textContent = now.toLocaleString('en-US', options).replace(',', '') + ' IST';
        }
        setInterval(updateTime, 1000);
        updateTime();

        // ==================== FETCH REAL-TIME DATA ====================
        async function fetchMarketData() {
            try {
                const response = await fetch(`${API_URL}/api/market-data`);
                if (response.ok) {
                    const data = await response.json();
                    updateMarketCards(data);
                    updateStockPrices(data.stocks || {});
                }
            } catch (error) {
                console.log('Using simulated data - API not available');
                simulateMarketData();
            }
        }

        function simulateMarketData() {
            // Simulate market indices
            const nifty = { value: 24856.50 + (Math.random() * 200 - 100), change: 186.45 + (Math.random() * 50 - 25) };
            nifty.changePct = (nifty.change / nifty.value * 100).toFixed(2);
            
            const sensex = { value: 81785.56 + (Math.random() * 500 - 250), change: 632.80 + (Math.random() * 100 - 50) };
            sensex.changePct = (sensex.change / sensex.value * 100).toFixed(2);
            
            const banknifty = { value: 52438.75 + (Math.random() * 300 - 150), change: -124.30 + (Math.random() * 80 - 40) };
            banknifty.changePct = (banknifty.change / banknifty.value * 100).toFixed(2);
            
            const vix = { value: 13.25 + (Math.random() * 2 - 1), change: 0.45 + (Math.random() * 0.5 - 0.25) };
            vix.changePct = (vix.change / vix.value * 100).toFixed(2);

            // Update cards
            updateMarketCard('nifty', nifty.value, nifty.change, nifty.changePct);
            updateMarketCard('sensex', sensex.value, sensex.change, sensex.changePct);
            updateMarketCard('banknifty', banknifty.value, banknifty.change, banknifty.changePct);
            updateMarketCard('vix', vix.value, vix.change, vix.changePct);

            // Update stock prices with small random changes
            stockData.forEach(stock => {
                const priceChange = (Math.random() * 2 - 1);
                stock.price = parseFloat((stock.price + priceChange).toFixed(2));
                stock.change = parseFloat((Math.random() * 10 - 5).toFixed(2));
                stock.changePct = parseFloat(((stock.change / stock.price) * 100).toFixed(2));
            });

            renderMovers();
        }

        function updateMarketCard(id, value, change, changePct) {
            const priceEl = document.getElementById(`${id}Price`);
            const changeEl = document.getElementById(`${id}Change`);
            
            priceEl.textContent = value.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            
            const isPositive = change >= 0;
            changeEl.textContent = `${isPositive ? '+' : ''}${change.toFixed(2)} (${isPositive ? '+' : ''}${changePct}%)`;
            changeEl.className = `market-card-change ${isPositive ? 'positive' : 'negative'}`;
        }

        function updateMarketCards(data) {
            if (data.nifty) updateMarketCard('nifty', data.nifty.value, data.nifty.change, data.nifty.changePct);
            if (data.sensex) updateMarketCard('sensex', data.sensex.value, data.sensex.change, data.sensex.changePct);
            if (data.banknifty) updateMarketCard('banknifty', data.banknifty.value, data.banknifty.change, data.banknifty.changePct);
            if (data.vix) updateMarketCard('vix', data.vix.value, data.vix.change, data.vix.changePct);
        }

        function updateStockPrices(prices) {
            Object.keys(prices).forEach(ticker => {
                const stock = stockData.find(s => s.ticker === ticker);
                if (stock && prices[ticker]) {
                    stock.price = prices[ticker].price;
                    stock.change = prices[ticker].change;
                    stock.changePct = prices[ticker].changePct;
                }
            });
            renderMovers();
            renderScreenerTable();
        }

        // ==================== MOVERS ====================
        function renderMovers() {
            const sorted = [...stockData].sort((a, b) => b.changePct - a.changePct);
            const gainers = sorted.slice(0, 5);
            const losers = sorted.slice(-5).reverse();

            document.getElementById('topGainers').innerHTML = gainers.map(s => `
                <div class="mover-row" onclick="openStock('${s.ticker}')">
                    <div class="mover-info">
                        <div class="mover-ticker">${s.ticker}</div>
                        <div class="mover-name">${s.name.substring(0, 25)}${s.name.length > 25 ? '...' : ''}</div>
                    </div>
                    <div class="mover-price">
                        <div class="mover-ltp">₹${s.price.toLocaleString()}</div>
                        <div class="mover-change positive">+${s.changePct.toFixed(2)}%</div>
                    </div>
                </div>
            `).join('');

            document.getElementById('topLosers').innerHTML = losers.map(s => `
                <div class="mover-row" onclick="openStock('${s.ticker}')">
                    <div class="mover-info">
                        <div class="mover-ticker">${s.ticker}</div>
                        <div class="mover-name">${s.name.substring(0, 25)}${s.name.length > 25 ? '...' : ''}</div>
                    </div>
                    <div class="mover-price">
                        <div class="mover-ltp">₹${s.price.toLocaleString()}</div>
                        <div class="mover-change negative">${s.changePct.toFixed(2)}%</div>
                    </div>
                </div>
            `).join('');
        }

        // ==================== SCREENER ====================
        let activeTab = 'descriptive';

        document.querySelectorAll('.tab-pill[data-tab]').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab-pill[data-tab]').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                activeTab = tab.dataset.tab;
                
                document.getElementById('descriptiveFilters').style.display = activeTab === 'descriptive' ? 'block' : 'none';
                document.getElementById('fundamentalFilters').style.display = activeTab === 'fundamental' ? 'block' : 'none';
                document.getElementById('technicalFilters').style.display = activeTab === 'technical' ? 'block' : 'none';
                
                renderScreenerTable();
            });
        });

        function renderScreenerTable() {
            const headers = {
                descriptive: `<tr><th>No.</th><th>Ticker ▲</th><th>Company</th><th>Sector</th><th>Industry</th><th>Country</th><th>Market Cap</th><th>P/E</th><th>Price</th><th>Change</th><th>Volume</th></tr>`,
                fundamental: `<tr><th>No.</th><th>Ticker ▲</th><th>Company</th><th>P/E</th><th>P/B</th><th>EPS</th><th>ROE</th><th>ROA</th><th>D/E</th><th>Div Yield</th><th>Price</th><th>Change</th></tr>`,
                technical: `<tr><th>No.</th><th>Ticker ▲</th><th>Company</th><th>Price</th><th>Change</th><th>RSI</th><th>SMA50</th><th>SMA200</th><th>Beta</th><th>Volume</th><th>High</th><th>Low</th></tr>`
            };

            document.getElementById('tableHead').innerHTML = headers[activeTab];

            const start = (currentPage - 1) * pageSize;
            const pageData = stockData.slice(start, start + pageSize);

            let rows = '';
            pageData.forEach((s, i) => {
                const changeClass = s.changePct >= 0 ? 'positive' : 'negative';
                const changePrefix = s.changePct >= 0 ? '+' : '';

                if (activeTab === 'descriptive') {
                    rows += `<tr onclick="openStock('${s.ticker}')">
                        <td>${start + i + 1}</td>
                        <td><a class="ticker-link">${s.ticker}</a></td>
                        <td style="font-family: Inter, sans-serif;">${s.name}</td>
                        <td>${s.sector}</td>
                        <td>${s.industry}</td>
                        <td>India</td>
                        <td>₹${(s.marketCap / 1000).toFixed(0)}K Cr</td>
                        <td>${s.pe.toFixed(2)}</td>
                        <td class="${changeClass}">${s.price.toFixed(2)}</td>
                        <td class="${changeClass}">${changePrefix}${s.changePct.toFixed(2)}%</td>
                        <td>${(s.volume / 1000000).toFixed(2)}M</td>
                    </tr>`;
                } else if (activeTab === 'fundamental') {
                    rows += `<tr onclick="openStock('${s.ticker}')">
                        <td>${start + i + 1}</td>
                        <td><a class="ticker-link">${s.ticker}</a></td>
                        <td style="font-family: Inter, sans-serif;">${s.name}</td>
                        <td>${s.pe.toFixed(2)}</td>
                        <td>${s.pb.toFixed(2)}</td>
                        <td>${s.eps.toFixed(2)}</td>
                        <td class="${s.roe >= 15 ? 'positive' : ''}">${s.roe.toFixed(1)}%</td>
                        <td>${s.roa.toFixed(1)}%</td>
                        <td class="${s.debtEquity > 1 ? 'negative' : ''}">${s.debtEquity.toFixed(2)}</td>
                        <td>${s.dividend.toFixed(2)}%</td>
                        <td class="${changeClass}">${s.price.toFixed(2)}</td>
                        <td class="${changeClass}">${changePrefix}${s.changePct.toFixed(2)}%</td>
                    </tr>`;
                } else {
                    rows += `<tr onclick="openStock('${s.ticker}')">
                        <td>${start + i + 1}</td>
                        <td><a class="ticker-link">${s.ticker}</a></td>
                        <td style="font-family: Inter, sans-serif;">${s.name}</td>
                        <td class="${changeClass}">${s.price.toFixed(2)}</td>
                        <td class="${changeClass}">${changePrefix}${s.changePct.toFixed(2)}%</td>
                        <td class="${s.rsi > 70 ? 'negative' : s.rsi < 30 ? 'positive' : ''}">${s.rsi.toFixed(1)}</td>
                        <td class="${s.sma50 === 'Above' ? 'positive' : 'negative'}">${s.sma50}</td>
                        <td class="${s.sma200 === 'Above' ? 'positive' : 'negative'}">${s.sma200}</td>
                        <td>${s.beta.toFixed(2)}</td>
                        <td>${(s.volume / 1000000).toFixed(2)}M</td>
                        <td>${s.high.toFixed(2)}</td>
                        <td>${s.low.toFixed(2)}</td>
                    </tr>`;
                }
            });

            document.getElementById('tableBody').innerHTML = rows;
            document.getElementById('stockCount').textContent = `#1 / ${stockData.length} Total`;
            document.getElementById('pageInfo').textContent = `Page ${currentPage} / ${Math.ceil(stockData.length / pageSize)}`;
        }

        // ==================== SEARCH ====================
        const searchInput = document.getElementById('globalSearch');
        const searchDropdown = document.getElementById('searchDropdown');

        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            if (query.length < 1) {
                searchDropdown.classList.remove('show');
                return;
            }

            const matches = stockData.filter(s => 
                s.ticker.toLowerCase().includes(query) || 
                s.name.toLowerCase().includes(query)
            ).slice(0, 10);

            if (matches.length > 0) {
                searchDropdown.innerHTML = matches.map(s => `
                    <div class="search-result" onclick="openStock('${s.ticker}')">
                        <div>
                            <span class="ticker-link">${s.ticker}</span>
                            <span style="color: var(--text-secondary); margin-left: 12px;">${s.name}</span>
                        </div>
                        <div style="text-align: right;">
                            <span>₹${s.price.toFixed(2)}</span>
                            <span class="${s.changePct >= 0 ? 'positive' : 'negative'}" style="margin-left: 8px;">${s.changePct >= 0 ? '+' : ''}${s.changePct.toFixed(2)}%</span>
                        </div>
                    </div>
                `).join('');
                searchDropdown.classList.add('show');
            } else {
                searchDropdown.classList.remove('show');
            }
        });

        document.addEventListener('click', (e) => {
            if (!searchInput.contains(e.target) && !searchDropdown.contains(e.target)) {
                searchDropdown.classList.remove('show');
            }
        });

        // ==================== STOCK DETAIL ====================
        function openStock(ticker) {
            const stock = stockData.find(s => s.ticker === ticker);
            if (!stock) return;

            searchDropdown.classList.remove('show');
            searchInput.value = '';

            document.getElementById('detailName').textContent = stock.name;
            document.getElementById('detailTicker').textContent = stock.ticker;
            document.getElementById('detailMeta').textContent = `${stock.sector} | ${stock.industry} | NSE`;
            document.getElementById('detailPrice').textContent = `₹${stock.price.toLocaleString()}`;
            
            const changeEl = document.getElementById('detailChange');
            changeEl.textContent = `${stock.change >= 0 ? '+' : ''}${stock.change.toFixed(2)} (${stock.changePct >= 0 ? '+' : ''}${stock.changePct.toFixed(2)}%)`;
            changeEl.className = `stock-change-display ${stock.changePct >= 0 ? 'positive' : 'negative'}`;

            // Technical indicators
            document.getElementById('indicatorsGrid').innerHTML = `
                <div class="indicator-card">
                    <div class="indicator-label">RSI (14)</div>
                    <div class="indicator-value">${stock.rsi.toFixed(2)}</div>
                    <span class="indicator-signal ${stock.rsi > 70 ? 'signal-sell' : stock.rsi < 30 ? 'signal-buy' : 'signal-neutral'}">${stock.rsi > 70 ? 'Overbought' : stock.rsi < 30 ? 'Oversold' : 'Neutral'}</span>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">50-Day SMA</div>
                    <div class="indicator-value">₹${(stock.price * 0.97).toFixed(2)}</div>
                    <span class="indicator-signal ${stock.sma50 === 'Above' ? 'signal-buy' : 'signal-sell'}">${stock.sma50}</span>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">200-Day SMA</div>
                    <div class="indicator-value">₹${(stock.price * 0.92).toFixed(2)}</div>
                    <span class="indicator-signal ${stock.sma200 === 'Above' ? 'signal-buy' : 'signal-sell'}">${stock.sma200}</span>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">Beta</div>
                    <div class="indicator-value">${stock.beta.toFixed(2)}</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">52W High</div>
                    <div class="indicator-value">₹${(stock.price * 1.15).toFixed(2)}</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">52W Low</div>
                    <div class="indicator-value">₹${(stock.price * 0.75).toFixed(2)}</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">Volume</div>
                    <div class="indicator-value">${(stock.volume / 1000000).toFixed(1)}M</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">Day Range</div>
                    <div class="indicator-value">${stock.low.toFixed(0)} - ${stock.high.toFixed(0)}</div>
                </div>
            `;

            // Fundamental ratios
            document.getElementById('ratiosGrid').innerHTML = `
                <div class="indicator-card">
                    <div class="indicator-label">P/E Ratio</div>
                    <div class="indicator-value">${stock.pe.toFixed(2)}</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">P/B Ratio</div>
                    <div class="indicator-value">${stock.pb.toFixed(2)}</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">EPS</div>
                    <div class="indicator-value">₹${stock.eps.toFixed(2)}</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">ROE</div>
                    <div class="indicator-value">${stock.roe.toFixed(1)}%</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">ROA</div>
                    <div class="indicator-value">${stock.roa.toFixed(1)}%</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">Debt/Equity</div>
                    <div class="indicator-value">${stock.debtEquity.toFixed(2)}</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">Dividend Yield</div>
                    <div class="indicator-value">${stock.dividend.toFixed(2)}%</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">Market Cap</div>
                    <div class="indicator-value">₹${(stock.marketCap / 1000).toFixed(0)}K Cr</div>
                </div>
            `;

            showPage('stockDetail');
        }

        // Stock detail tabs
        document.querySelectorAll('.tab-pill[data-stocktab]').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab-pill[data-stocktab]').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                const tabName = tab.dataset.stocktab;
                document.getElementById('stockTechnicalTab').style.display = tabName === 'technical' ? 'block' : 'none';
                document.getElementById('stockFundamentalTab').style.display = tabName === 'fundamental' ? 'block' : 'none';
            });
        });

        // ==================== OPTION CHAIN ====================
        function renderOptionChain() {
            const underlying = document.getElementById('optionUnderlying').value;
            const spotPrices = {
                'NIFTY': 24856.50, 'BANKNIFTY': 52438.75, 'FINNIFTY': 23450.25,
                'RELIANCE': 2856.45, 'TCS': 4125.30, 'HDFCBANK': 1685.20,
                'INFY': 1825.60, 'ICICIBANK': 1245.80, 'SBIN': 825.30,
                'BHARTIARTL': 1580.45, 'ITC': 465.80, 'KOTAKBANK': 1785.40,
                'LT': 3525.60, 'AXISBANK': 1165.30, 'TATAMOTORS': 785.60
            };

            const spotPrice = spotPrices[underlying] || 24856.50;
            document.getElementById('spotPrice').textContent = spotPrice.toLocaleString('en-IN', { minimumFractionDigits: 2 });

            const stepSize = underlying.includes('NIFTY') ? 100 : underlying.includes('BANK') ? 100 : 50;
            const baseStrike = Math.round(spotPrice / stepSize) * stepSize;
            const strikes = [];
            
            for (let i = -10; i <= 10; i++) {
                strikes.push(baseStrike + (i * stepSize));
            }

            document.getElementById('optionChainBody').innerHTML = strikes.map(strike => {
                const isATM = strike === baseStrike;
                const isITMCall = strike < spotPrice;
                const isITMPut = strike > spotPrice;
                
                let rowClass = '';
                if (isATM) rowClass = 'atm-row';
                else if (isITMCall) rowClass = 'itm-call';
                else if (isITMPut) rowClass = 'itm-put';

                const callOI = Math.floor(Math.random() * 500000) + 50000;
                const putOI = Math.floor(Math.random() * 500000) + 50000;
                const callLTP = Math.max(5, spotPrice - strike + Math.random() * 30).toFixed(2);
                const putLTP = Math.max(5, strike - spotPrice + Math.random() * 30).toFixed(2);
                const callChg = (Math.random() * 40 - 20).toFixed(2);
                const putChg = (Math.random() * 40 - 20).toFixed(2);
                const iv = (12 + Math.random() * 8).toFixed(2);

                return `
                    <tr class="${rowClass}">
                        <td>${callOI.toLocaleString()}</td>
                        <td class="${Math.random() > 0.5 ? 'positive' : 'negative'}">${(Math.random() * 50000 - 25000).toFixed(0)}</td>
                        <td>${Math.floor(Math.random() * 80000)}</td>
                        <td>${iv}%</td>
                        <td style="font-weight: 600;">${callLTP}</td>
                        <td class="${parseFloat(callChg) >= 0 ? 'positive' : 'negative'}">${callChg}</td>
                        <td class="strike-col">${strike}</td>
                        <td class="${parseFloat(putChg) >= 0 ? 'positive' : 'negative'}">${putChg}</td>
                        <td style="font-weight: 600;">${putLTP}</td>
                        <td>${iv}%</td>
                        <td>${Math.floor(Math.random() * 80000)}</td>
                        <td class="${Math.random() > 0.5 ? 'positive' : 'negative'}">${(Math.random() * 50000 - 25000).toFixed(0)}</td>
                        <td>${putOI.toLocaleString()}</td>
                    </tr>
                `;
            }).join('');
        }

        document.getElementById('optionUnderlying').addEventListener('change', renderOptionChain);
        document.getElementById('optionExpiry').addEventListener('change', renderOptionChain);

        // ==================== RATING TRACKER ====================
        const ratingAgencies = [
            { name: 'CRISIL', type: 'Credit Rating Agency', accuracy: 82, totalRatings: 1240, successRate: 78, avgReturn: 18.5, picks: [{ stock: 'RELIANCE', rating: 'buy', target: 3200, return: 12.5 }, { stock: 'TCS', rating: 'hold', target: 4200, return: -2.3 }, { stock: 'HDFCBANK', rating: 'buy', target: 1850, return: 8.2 }] },
            { name: 'Motilal Oswal', type: 'Research House', accuracy: 78, totalRatings: 890, successRate: 74, avgReturn: 15.2, picks: [{ stock: 'INFY', rating: 'buy', target: 2050, return: 15.8 }, { stock: 'ICICIBANK', rating: 'buy', target: 1400, return: 10.5 }] },
            { name: 'ICICI Securities', type: 'Brokerage', accuracy: 75, totalRatings: 1050, successRate: 71, avgReturn: 12.8, picks: [{ stock: 'SBIN', rating: 'buy', target: 920, return: -5.2 }, { stock: 'ITC', rating: 'buy', target: 520, return: 18.5 }] },
            { name: 'HDFC Securities', type: 'Brokerage', accuracy: 76, totalRatings: 780, successRate: 73, avgReturn: 14.2, picks: [{ stock: 'BHARTIARTL', rating: 'buy', target: 1750, return: 22.5 }, { stock: 'KOTAKBANK', rating: 'hold', target: 1850, return: 5.2 }] },
            { name: 'Kotak Securities', type: 'Brokerage', accuracy: 74, totalRatings: 920, successRate: 70, avgReturn: 11.5, picks: [{ stock: 'TATAMOTORS', rating: 'buy', target: 850, return: 18.2 }, { stock: 'M&M', rating: 'buy', target: 3200, return: 25.8 }] },
            { name: 'Axis Securities', type: 'Brokerage', accuracy: 72, totalRatings: 650, successRate: 68, avgReturn: 10.8, picks: [{ stock: 'SUNPHARMA', rating: 'buy', target: 1850, return: 8.5 }] },
        ];

        function renderRatingAgencies() {
            document.getElementById('ratingGrid').innerHTML = ratingAgencies.map(agency => {
                const accClass = agency.accuracy >= 80 ? 'accuracy-high' : agency.accuracy >= 70 ? 'accuracy-medium' : 'accuracy-low';
                const accColor = agency.accuracy >= 80 ? 'var(--accent-green)' : agency.accuracy >= 70 ? 'var(--accent-yellow)' : 'var(--accent-red)';
                
                return `
                <div class="rating-card">
                    <div class="rating-card-header">
                        <div>
                            <div class="rating-agency-name">${agency.name}</div>
                            <div class="rating-agency-type">${agency.type}</div>
                        </div>
                        <div class="accuracy-circle ${accClass}">
                            <div class="accuracy-value" style="color: ${accColor}">${agency.accuracy}%</div>
                            <div class="accuracy-label">Accuracy</div>
                        </div>
                    </div>
                    <div class="rating-stats">
                        <div class="stat-item">
                            <div class="stat-value">${agency.totalRatings}</div>
                            <div class="stat-label">Ratings</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${agency.successRate}%</div>
                            <div class="stat-label">Success</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${agency.avgReturn}%</div>
                            <div class="stat-label">Avg Return</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${agency.picks.length}</div>
                            <div class="stat-label">Active</div>
                        </div>
                    </div>
                    <div class="rating-picks">
                        <div class="rating-picks-title">Recent Picks</div>
                        ${agency.picks.map(p => `
                            <div class="pick-row">
                                <div>
                                    <span class="pick-stock">${p.stock}</span>
                                    <span class="pick-rating ${p.rating}">${p.rating}</span>
                                </div>
                                <div>
                                    <span class="pick-target">Target: ₹${p.target}</span>
                                    <span class="pick-return ${p.return >= 0 ? 'positive' : 'negative'}" style="margin-left: 12px;">${p.return >= 0 ? '+' : ''}${p.return}%</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `}).join('');
        }

        // ==================== LEARNING HUB ====================
        const articles = [
            { title: 'Introduction to Quantitative Finance', category: 'beginner', excerpt: 'Learn the fundamentals of quantitative analysis in financial markets. Understand key concepts like risk, return, and portfolio theory.', time: '15 min', icon: '📊' },
            { title: 'Understanding Technical Indicators', category: 'beginner', excerpt: 'Master RSI, MACD, Moving Averages, and Bollinger Bands. Learn how to use them for better trading decisions.', time: '20 min', icon: '📈' },
            { title: 'Option Greeks Explained', category: 'intermediate', excerpt: 'Deep dive into Delta, Gamma, Theta, Vega, and Rho. Understand how options prices move and how to hedge your positions.', time: '25 min', icon: '🎯' },
            { title: 'Building a Factor Model', category: 'advanced', excerpt: 'Learn to construct multi-factor models for alpha generation. Implement momentum, value, and quality factors in your strategy.', time: '40 min', icon: '🔬' },
            { title: 'Pairs Trading Strategy', category: 'intermediate', excerpt: 'Statistical arbitrage using cointegration. Learn to identify and trade mean-reverting pairs in Indian markets.', time: '30 min', icon: '🔄' },
            { title: 'Machine Learning in Trading', category: 'advanced', excerpt: 'Apply ML algorithms for price prediction and strategy optimization. From regression to neural networks.', time: '45 min', icon: '🤖' },
        ];

        function renderLearningHub() {
            document.getElementById('learningGrid').innerHTML = articles.map(a => `
                <div class="article-card">
                    <div class="article-image ${a.category}">${a.icon}</div>
                    <div class="article-content">
                        <span class="article-category ${a.category}">${a.category}</span>
                        <h3 class="article-title">${a.title}</h3>
                        <p class="article-excerpt">${a.excerpt}</p>
                        <div class="article-meta">
                            <span>📖 ${a.time} read</span>
                            <span class="article-link">Read More →</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ==================== INITIALIZE ====================
        function init() {
            simulateMarketData();
            renderScreenerTable();
            renderOptionChain();
            renderRatingAgencies();
            renderLearningHub();
            
            // Try to fetch real data
            fetchMarketData();
            
            // Refresh data every 30 seconds
            setInterval(() => {
                fetchMarketData();
            }, 30000);
        }

        init();
    </script>
</body>
</html>
